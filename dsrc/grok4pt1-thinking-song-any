#include <stdio.h>
#include <unistd.h>

#ifdef _WIN32
#include <windows.h>
#define SLEEP(ms) Sleep(ms)
#else
#define SLEEP(ms) usleep((ms) * 1000LL)
#endif

/* Super Mario Bros overworld theme - full main section */
void main(void) {
    const int freq[] = {
        659,659,0,659,0,523,659,0,784,0,0,0,392,0,0,0,
        523,0,0,392,0,0,330,0,0,0,392,0,0,0,523,0,
        784,392,0,523,0,0,392,0,0,330,0,0,392,0,0,0,
        523,0,784,392,0,523,0,0,392,0,0,330,0,0,392,0,
        659,659,659,0,523,523,523,0,392,392,440,440,494,494,523,0,
        784,784,740,698,659,0,523,523,587,587,659,659,698,0,
        784,784,740,698,659,0,523,523,587,587,659,659,698,0,
        784,784,932,880,784,740,698,0,659,659,659,659,659,659,659,0,
        659,659,659,0,523,523,523,0,392,392,440,440,494,494,523,0
    };
    const int dur[] = {
        150,150,150,150,150,150,150,150,150,300,150,150,300,150,150,300,
        150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,
        150,400,150,150,150,150,150,150,150,150,150,150,150,150,150,150,
        150,150,150,400,150,150,150,150,150,150,150,150,150,150,150,150,
        150,150,300,150,150,150,300,150,150,150,150,150,150,150,300,
        150,150,150,150,300,150,150,150,150,150,150,150,300,
        150,150,150,150,300,150,150,150,150,150,150,150,300,
        150,150,150,150,300,150,150,150,150,150,150,150,150,150,150,150,
        150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,300
    };

    int n = sizeof(freq)/sizeof(freq[0]);

    for (int i = 0; i < n; i++) {
#ifdef _WIN32
        if (freq[i]) Beep(freq[i], dur[i]);
        else Sleep(dur[i]);
#else
        if (freq[i]) { putchar('\a'); fflush(stdout); }
#endif
        SLEEP(dur[i] + 30);  /* small gap between notes */
    }
}
